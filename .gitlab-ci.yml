image: jangrewe/gitlab-ci-android
stages:
- build
- test
before_script:
- export GRADLE_USER_HOME=$(pwd)/.gradle
- chmod +x ./gradlew

cache:
  key: ${CI_BUILD_ID}
  paths:
  - .gradle/
  - .gradle/wrapper
  - .gradle/caches
  - build/
  - app/build

build :
    stage: build    
    script:
    - chmod 755 gradlew
    - "echo build: $CI_BUILD_ID >> build"
    - ./gradlew build
    cache:
        paths:
        - .gradle/
        - .gradle/wrapper
        - .gradle/caches
        - build/
        - app/build
    artifacts:
        paths:
        - build/*

test:
  stage: test
  dependencies: 
    - build
  script:
    - "echo test: $CI_BUILD_ID >> test"   
    - ls -al
  artifacts:
      paths:
      - test/*
      

